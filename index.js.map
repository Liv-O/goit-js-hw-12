{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\n\nexport async function getImagesByQuery(query, page) {\n\n    const API_key = '52541009-8475ad66b76bd384e4dad34fd';\n    let perPage = 15;\n\n    const param = new URLSearchParams({\n        key: API_key,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page,\n        per_page: perPage\n    });\n\n    const response = await axios.get(`https://pixabay.com/api/?${param}`);\n    return response.data;\n        \n          \n}\n\n","import SimpleLightbox from 'simplelightbox';\n\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet gallery; \n\nexport function createGallery(images) {\n\n    const list = document.querySelector('.gallery');\n   \n    const imagesElements = images.map(({ webformatURL, largeImageURL, tags, views, likes, comments, downloads }) => {\n        return `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n           <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n            />\n        </a>\n        <table class=\"gallery-item-desc\">\n         <tr>\n          <th>Likes</th>\n          <th>Views</th>\n          <th>Comments</th>\n          <th>Downloads</th>\n         </tr>\n         <tr>\n          <td>${likes}</td>\n          <td>${views}</td>\n          <td>${comments}</td>\n          <td>${downloads}</td>\n         </tr>\n        </table>\n       </li>`;\n    }).join('');\n     \n    if (list) {\n        list.insertAdjacentHTML('beforeend', imagesElements);\n\n        if (!gallery) {\n\n            gallery = new SimpleLightbox('.gallery a', {\n                captions: true,\n                captionsData: 'alt',\n                captionPosition: 'bottom',\n                captionDelay: 250,\n            });\n\n        } else {\n            gallery.refresh();\n        }\n\n        gallery.on('show.simplelightbox', function (event) {\n            console.log(`opened image : ${event.target.querySelector('img').alt} :) `);\n        });\n    }\n    \n}\n\nexport function clearGallery() {\n    const list = document.querySelector('.gallery');\n    \n   if(list) list.innerHTML = '';\n\n}\n\nexport function showLoader() {\n    const loader = document.querySelector('.loader');\n    \n    if(loader) loader.classList.remove('hidden');\n}\n\nexport function hideLoader() {\n    const loader = document.querySelector('.loader');\n    \n    if(loader) loader.classList.add('hidden');\n}\n\nexport function showLoadMoreButton() {\n    const btn = document.querySelector('.load-btn');\n\n    if(btn) btn.classList.remove('hidden');\n}\n\nexport function hideLoadMoreButton() {\n    const btn = document.querySelector('.load-btn');\n\n     if(btn) btn.classList.add('hidden');\n}","\nimport { getImagesByQuery } from './js/pixabay-api';\nimport { createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton } from './js/render-functions';\n\n\nimport iziToast from \"izitoast\";\n\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\nconst form = document.querySelector('.form');\nconst input = document.querySelector('input');\nconst btn = document.querySelector('.load-btn');\nlet q, totalPages;\nlet page = 1;\nlet perPage = 15;\n\n\nconst hanlderSubmit = async function (event) {\n    event.preventDefault();\n    page = 1;\n    q = event.target.elements['search-text'].value.toLowerCase().trim();\n    if (q === '') {\n        iziToast.error({\n            message: 'Fill your answer',\n        });\n    } else {\n        input.value = '';\n        showLoader();\n        clearGallery();\n        try {\n            const { hits: posts, totalHits } = await getImagesByQuery(q, page);\n            hideLoader();\n            totalPages = Math.ceil(totalHits / perPage);\n            if (posts.length === 0) {\n                iziToast.error({\n                    message: 'Sorry, there are no images matching your search query. Please try again!',\n                });\n                    \n            } else {\n                createGallery(posts);\n                page++;\n                if (page >= totalPages) {\n                    hideLoadMoreButton();\n                    iziToast.warning({\n                        message: \"We're sorry, but you've reached the end of search results.\",\n                   });\n                } else {\n                     showLoadMoreButton();\n                }        \n            }\n        } catch (error) {\n            hideLoader();\n            iziToast.error({\n                message: `Sorry, ${error}`,\n            });\n        }\n    }\n        \n};\n\nasync function handlerLoad() {\n    hideLoadMoreButton();\n    showLoader();\n    try {\n            const { hits: posts } = await getImagesByQuery(q, page);\n            hideLoader();\n            if (posts.length === 0) {\n                iziToast.error({\n                    message: 'Sorry, there are no images matching your search query. Please try again!',\n                });\n                    \n            } else {\n                createGallery(posts);\n                const galleryItem = document.querySelector('.gallery-item');\n                let {height} = galleryItem.getBoundingClientRect();\n                height *= 2; \n                window.scrollBy({\n                       top: height,\n                       behavior: 'smooth' \n                    });\n                page++;\n                if (page >= totalPages) {\n                    iziToast.warning({\n                        message: \"We're sorry, but you've reached the end of search results.\",\n                   });\n                } else {\n                     showLoadMoreButton();\n                }         \n            }\n        } catch (error) {\n            hideLoader();\n            iziToast.error({\n                message: `Sorry, ${error}`,\n            });\n        //\n        }\n\n}\n\n\nform.addEventListener('submit', hanlderSubmit);\nbtn.addEventListener('click', handlerLoad);\n\n"],"names":["getImagesByQuery","query","page","API_key","perPage","param","axios","gallery","createGallery","images","list","imagesElements","webformatURL","largeImageURL","tags","views","likes","comments","downloads","SimpleLightbox","event","clearGallery","showLoader","loader","hideLoader","showLoadMoreButton","btn","hideLoadMoreButton","form","input","q","totalPages","hanlderSubmit","iziToast","posts","totalHits","error","handlerLoad","galleryItem","height"],"mappings":"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"}